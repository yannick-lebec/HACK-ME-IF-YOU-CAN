<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Explication ‚Äì Level 2 (XSS Reflected)</title>
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body class="matrix-body">
    
    <div
      class="matrix-content"
      style="align-items:flex-start; text-align:left; max-width:800px;"
    >
      <h1>Level 2 ‚Äì XSS (Reflected)</h1>
      <p class="subtitle">
        Ce niveau montre une faille classique : une entr√©e utilisateur r√©affich√©e
        tel quel dans la page.
      </p>

      <h2>‚ö†Ô∏è Ce qui √©tait vuln√©rable</h2>
      <p>Dans la page de recherche, le code faisait ceci :</p>

      <pre
        style="white-space:pre-wrap; background:rgba(15,23,42,0.9); padding:12px; border-radius:8px;"
      >&lt;p&gt;
  <!-- ‚ö†Ô∏è Injection directe, XSS possible -->
  ${q}
&lt;/p&gt;</pre>

      <p>
        Le param√®tre <code>q</code> provenant de l'URL (GET) √©tait inject√©
        directement dans le HTML, sans √©chappement ni filtrage.
      </p>

      <h2>üîç Comment tu as exploit√© la vuln√©rabilit√©</h2>
      <ul>
        <li>Tu as test√© avec du texte normal ‚Üí rien de sp√©cial.</li>
        <li>
          Puis tu as essay√© d'injecter du HTML/JS avec une balise :
          <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code>.
        </li>
        <li>
          Le navigateur a interpr√©t√© ce script car il a √©t√© inclus dans le DOM
          sans protection.
        </li>
      </ul>

      <h2>‚úÖ Ce qu'il faudrait faire en vrai</h2>
      <ul>
        <li>√âchapper syst√©matiquement les valeurs avant de les injecter dans le HTML.</li>
        <li>Utiliser des templates ou des fonctions qui prot√®gent par d√©faut.</li>
        <li>
          √âviter d'injecter directement des cha√Ænes dans
          <code>innerHTML</code>, et pr√©f√©rer <code>textContent</code>.
        </li>
      </ul>

      <p>Exemple c√¥t√© serveur :</p>
      <pre
        style="white-space:pre-wrap; background:rgba(15,23,42,0.9); padding:12px; border-radius:8px;"
      >// Par exemple : encoder les caract√®res sp√©ciaux (&, <, >, ", ')
function escapeHtml(str) {
  return str
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
}</pre>

      <p style="margin-top:20px;">
        <a href="/game" class="btn btn-secondary">üè† Retour au hub</a>
      </p>
    </div>

  </body>
</html>